<div class="bg-gray-200 py-10 flex flex-col items-center justify-center w-full">
  <form
    class="flex flex-col bg-white shadow-lg w-2/3 md:w-4/5 xl:w-3/5 2xl:w-1/2 p-10 rounded-3xl"
    [formGroup]="group"
    (ngSubmit)="submit()">
    <app-env-banner class="w-full"></app-env-banner>
    <div *ngIf="environmentId" class="w-full bg-brand-400 text-center">
      You are in <strong>{{ environmentId }}</strong> environment.
    </div>
    <p
      class="inline-block p-3 m-6 text-2xl font-semibold text-center tracking-wider text-teal-900 uppercase bg-teal-accent-400">
      Provide new Connector <br />
      for Another Organization.
    </p>
    <div class="select-none flex flex-col justify-between items-center my-2">
      <div class="flex flex-col justify-between items-center w-full">
        <label class="label w-full mb-2" for="formProvConName"
          >Connector's Name</label
        >
        <input
          id="formProvConName"
          class="w-full border-b-2 border-gray-400 mb-3 py-1 pl-2"
          type="text"
          formControlName="name"
          placeholder="The name of your connector." />
      </div>

      <ng-container
        *ngIf="
          group.controls.name.touched &&
          group.controls.name.dirty &&
          group.controls.name.hasError('required')
        "
        class="mt-3 text-red-600">
        Name is a required field
      </ng-container>
    </div>

    <div class="select-none flex flex-col justify-between items-center my-2">
      <div class="flex flex-col justify-between items-center w-full">
        <label class="label w-full mb-2" for="formProvConLocation"
          >Connector's Location</label
        >
        <input
          id="formProvConLocation"
          class="w-full border-b-2 border-gray-400 mb-3 py-1 pl-2 resize-none"
          type="text"
          formControlName="location"
          placeholder="DE, UK, FR etc." />
      </div>

      <ng-container
        *ngIf="
          group.controls.location.touched &&
          group.controls.location.dirty &&
          group.controls.location.hasError('required')
        "
        class="mt-3 text-red-600">
        Connector's Location is a required field
      </ng-container>
    </div>

    <div class="select-none flex flex-col justify-between items-center my-2">
      <div class="flex flex-col justify-between items-center w-full">
        <label class="label w-full mb-2" for="formProvConUrl"
          >Endpoint URL</label
        >
        <input
          id="formProvConUrl"
          class="w-full border-b-2 border-gray-400 mb-3 py-1 pl-2"
          type="text"
          formControlName="url"
          placeholder="Url of the connector endpoint" />
      </div>

      <ng-container
        *ngIf="
          group.controls.url.touched &&
          group.controls.url.dirty &&
          group.controls.url.hasError('required')
        "
        class="mt-3 text-red-600">
        Endpoint URL is a required field
      </ng-container>
    </div>

    <div class="select-none flex flex-col justify-between items-center my-2">
      <div class="flex flex-col justify-between items-center w-full">
        <label class="label w-full mb-2" for="formProvConMdsId"
          >MDS ID of client Organization</label
        >
        <input
          id="formProvConUrl"
          class="w-full border-b-2 border-gray-400 mb-3 py-1 pl-2"
          type="text"
          formControlName="mdsId"
          placeholder="MDS ID of the client organization" />
      </div>

      <ng-container
        *ngIf="
          group.controls.mdsId.touched &&
          group.controls.mdsId.dirty &&
          group.controls.mdsId.hasError('required')
        "
        class="mt-3 text-red-600">
        MDS ID is a required field
      </ng-container>
    </div>

    <div class="flex gap-4 w-full">
      <div
        class="select-none flex-1 flex flex-col justify-between items-center my-2">
        <div class="flex flex-col justify-between items-center w-full">
          <div class="w-full flex justify-between">
            <label class="label mb-2 w-full" for="formRegOConPubCertKey"
              >Public key of your certificate</label
            >
          </div>

          <textarea
            id="formRegOConPubCertKey"
            class="w-full border-b-2 border-gray-400 mb-3 py-1 pl-1 h-48 resize-none"
            type="text"
            formControlName="certificate"
            placeholder="
            -----BEGIN CERTIFICATE-----
            MIICqjCCAhOgAwIBAgIBADANBgk
            ...
            AkmFH0MPvGNeUum02F0=
            -----END CERTIFICATE-----"></textarea>
        </div>

        <ng-container
          *ngIf="
            group.controls.certificate.touched &&
            group.controls.certificate.dirty &&
            group.controls.certificate.hasError('required')
          "
          class="mt-3 text-red-600">
          Public key of your certificate is a required field
        </ng-container>
      </div>
      <div class="flex flex-none gap-4 flex-col justify-start my-8">
        <button
          class="flex cursor-pointer items-center justify-start w-1/2 px-5 py-2 text-sm tracking-wide transition-colors duration-200 border text-blue-500 border-blue-500 rounded-lg shrink-0 sm:w-auto gap-x-2 enabled:hover:bg-blue-500 hover:text-white disabled:border-gray-300 disabled:text-gray-300 disabled:cursor-not-allowed"
          type="button"
          (click)="generateCertificate()">
          <svg
            class="w-5 h-5"
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            stroke-width="1.5"
            stroke="currentColor">
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M12 9v6m3-3H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg>

          <span>Generate Key</span>
        </button>
        <button
          class="flex cursor-pointer items-center justify-start w-1/2 px-5 py-2 text-sm tracking-wide transition-colors duration-200 border text-blue-500 border-blue-500 rounded-lg shrink-0 sm:w-auto gap-x-2 enabled:hover:bg-blue-500 hover:text-white disabled:border-gray-300 disabled:text-gray-300 disabled:cursor-not-allowed"
          type="button"
          [disabled]="!isDownloadActive"
          (click)="downloadPrivateKey()">
          <svg
            class="w-5 h-5"
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            stroke-width="1.5"
            stroke="currentColor">
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M12 5v9m0 0l-3-3m3 3l3-3M12 14v4m0 0H7m5 0h5" />
          </svg>

          <span>Download Private Key</span>
        </button>
      </div>
    </div>

    <div class="border-gray-400 inline-flex mt-4 justify-evenly w-full">
      <button
        class="select-none cursor-pointer bg-red-200 rounded-md text-center active:bg-red-300 hover:bg-red-300 hover:text-black my-auto w-2/5 p-3 focus:text-black focus:bg-red-300 disabled:bg-slate-500 disabled:text-gray-200"
        routerLink="/my-organization/connectors"
        [disabled]="state.state === 'submitting' || state.state === 'success'">
        Cancel
      </button>
      <button
        class="btn-green my-auto w-2/5 p-3"
        type="submit"
        [disabled]="!group.valid || state.state === 'submitting'">
        Provide
      </button>
    </div>
  </form>
</div>
